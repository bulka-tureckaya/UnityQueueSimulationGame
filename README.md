# Создание игры на юнити с имитационным моделированием на основе очередей

## Описание проекта
Данный проект представляет собой игру, созданную с использованием Unity, основанную на имитационном моделировании покупателей и очередей в магазине. Игра позволяет задавать вероятность появления покупателей в минуту и количество касс.

## Функциональность
- Имитация покупателей в магазине.
- Возможность задавать параметры: вероятность появления покупателей и количество касс.
- Визуализация процесса очереди через Unity.

## Используемые технологии
- Unity
- C#
- Visual Studio

## Ход работы
Проект основан на программе, созданной в Visual Studio, которая позволяет наблюдать за нагруженностью касс в магазинах и оценками обслуживания от покупателей. Для запуска программы необходимо ввести два значения: вероятность появления покупателя в следующую минуту в процентах и количество касс. Проект программы представлен в папке lab6.

![Конструктор](https://github.com/user-attachments/assets/b909dabf-11c1-48e0-99e6-c30aeecbab78)  
*Конструктор:* Верхний график отображает кассы и их загруженность. На оси X указаны индексы касс, на оси Y - количество покупателей на каждой из касс. На нижнем графике с течением времени появляются оценки обслуживания от покупателей.

![Пример работы программы](https://github.com/user-attachments/assets/0d950c3a-ef56-4372-ab3c-b33312eaec21)  
*Пример работы программы:* 

## Описание кода
Далее опишу сам код программы.
Данная программа реализует игру на Unity, в которой моделируется процесс обслуживания клиентов в магазине, используя имитационное моделирование очередей. Целью программы является визуализация потока покупателей и оценка качества обслуживания на основе времени ожидания.

### Основные функции программы
- Генерация покупателей: Программа создаёт покупателей, которые совершают покупки в магазине. Каждый покупатель может находиться в отделе товаров от 5 до 21 минуты, что задаётся случайным образом:
```csharp
newElement.time_shop = rng.Next(5, 21); // время покупок
```
Вероятность появления нового покупателя определяется пользователем.

- Выбор кассы: Каждый покупатель выбирает кассу, где меньше всего людей, используя метод SelectQueue:
```csharp
private Queue SelectQueue(List<Queue> queues)
{
    int min = 9999, indexOfQueue = -1;
    for (int i = 0; i < queues.Count; i++)
    {
        if (queues[i].count < min)
        {
            min = queues[i].count;
            indexOfQueue = i;
        }
    }
    return queues[indexOfQueue]; // Возвращает очередь с минимальным количеством людей
}
```

- Обработка очередей: Как только покупатель завершает свои покупки, он становится в очередь к кассе. Программа следит за временем, проведённым каждым покупателем в очереди:
```csharp
if (shop_people[i].time_shop <= 0)
{
    SelectQueue(cashRegisters).Push(shop_people[i]);
    shop_people.Remove(shop_people[i]);
}
```

- Оценки пользователей: После обслуживания покупателя программа запрашивает его оценку опыта в магазине на основе времени ожидания. Методы оценки Estimate возвращают оценку от 1 до 5:
```csharp
private int Estimate(int time)
{
    if (time < 5) return 5; // Отлично
    else if (time >= 5 && time < 10) return 4; // Хорошо
    else if (time >= 10 && time < 13) return 3; // Нормально
    else if (time >= 13 && time < 17) return 2; // Плохо
    else return 1; // Ужасно
}
```
- Визуализация данных: Программа отображает графики, показывающие:
Загруженность касс (количество покупателей в каждой кассе):
```csharp
for (int i = 0; i < cashRegisters.Count; i++)
{
    chart1.Series[0].Points.AddXY(i, cashRegisters[i].count);
}
```
Оценки обслуживания на протяжении времени, что позволяет отслеживать качество сервиса:
```csharp
for (int i = 0; i < Estimations.Count; i++)
{
    chart2.Series[0].Points.AddXY(i, Estimations[i]);
}
```

### Основные компоненты кода
- Класс Form1: Управляет всей логикой программы и интерфейсом. Включает инициализацию таймера, обработку событий кнопок, а также основные методы для работы с очередями и покупателями.
- Таймер: Запуск событий каждую секунду для обновления состояния программы:
```csharp
System.Timers.Timer timer = new System.Timers.Timer();
```
- Списки: Хранят данные о кассах, покупателях и оценках.

### Алгоритм работы
- При запуске пользователь вводит вероятность появления покупателей и количество касс.
- Каждую секунду программа проверяет, появляются ли новые покупатели.
- Каждый покупатель выбирает наиболее свободную кассу и ожидает своей очереди.
- После завершения обслуживания программа записывает оценку покупателя и визуализирует данные на графиках.
- Время симуляции продолжает увеличиваться, что позволяет наблюдать за изменениями в загруженности очередей и качеством обслуживания.
Эта программа демонстрирует, как с помощью имитационного моделирования можно визуализировать и анализировать поведение клиентов в магазине, а также проиллюстрировать влияние времени ожидания на их удовлетворенность.

## Работа с Unity
Игра будет состоять из двух сцен. Первая сцена необходима для ввода данных, на ней расположены две формы ввода (для вероятности появления покупателя и количества касс) и кнопка "Start".
![Первая сцена](https://github.com/user-attachments/assets/2f45c93b-fa38-4ca9-851c-d327a8abcc43)
Введенные данные будут использованы на второй сцене, она будет являться основной. Для визуальной составляющей были использованы бесплатные ассеты из магазина ассетов, а также простые объекты. Действие будет происходить в неком магазине, у данного магазина есть две комнаты - для полок с товарами и для касс. Покупатели будут появляться со стороны дороги и входить в первое помещение через дверь снизу, там они будут выбирать покупки. Далее пользователи переходят во второе помщение и встают в очередь на кассу. Когда покупка совершена, пользователь выходит через верхнюю дверь и в этот момент ставит оценку за обслуживание.
![Вторая сцена](https://github.com/user-attachments/assets/c2c4085c-b3c3-48ee-b641-e375148de1d2)
*Примерный вид сцены:*
На второй сцене есть кнока возврата, которая позволяет вернуться на первую сцену и поменять входные данные. Входные данные и график с оценками пользователей будут отображены в левом верхнем углу второй сцены.
